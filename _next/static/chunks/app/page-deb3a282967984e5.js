(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{7342:(e,t,s)=>{Promise.resolve().then(s.bind(s,5235))},5235:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var a=s(5155),l=s(2115);let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,l.forwardRef)((e,t)=>{let{color:s="currentColor",size:a=24,strokeWidth:r=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:m,...h}=e;return(0,l.createElement)("svg",{ref:t,...i,width:a,height:a,stroke:s,strokeWidth:o?24*Number(r)/Number(a):r,className:n("lucide",c),...h},[...m.map(e=>{let[t,s]=e;return(0,l.createElement)(t,s)}),...Array.isArray(d)?d:[d]])}),c=(e,t)=>{let s=(0,l.forwardRef)((s,a)=>{let{className:i,...c}=s;return(0,l.createElement)(o,{ref:a,iconNode:t,className:n("lucide-".concat(r(e)),i),...c})});return s.displayName="".concat(e),s},d=c("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),m=c("SkipBack",[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]]),h=c("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]),x=c("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),u=c("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);function g(e){var t,s;let{currentTrack:l,onPlaybackControl:r}=e;if(!(null==l?void 0:l.item))return null;let n=l.is_recent;return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,a.jsx)("div",{className:"w-full text-center mb-2",children:(0,a.jsx)("p",{className:"text-sm text-gray-600 flex items-center justify-center gap-2",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d,{size:16}),"Last Played Track"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Currently Playing"]})})}),(null===(s=l.item.album)||void 0===s?void 0:null===(t=s.images)||void 0===t?void 0:t[0])&&(0,a.jsx)("img",{src:l.item.album.images[0].url,alt:l.item.name,className:"w-64 h-64 rounded-lg shadow-lg"}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:l.item.name}),(0,a.jsx)("p",{className:"text-gray-600",children:l.item.artists.map(e=>e.name).join(", ")})]}),!n&&void 0!==l.progress_ms&&(0,a.jsx)(y,{progress_ms:l.progress_ms,duration_ms:l.item.duration_ms}),!n&&(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,a.jsx)("button",{onClick:()=>r("previous"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,a.jsx)(m,{size:24})}),(0,a.jsx)("button",{onClick:()=>r(l.is_playing?"pause":"play"),className:"p-3 hover:bg-gray-100 rounded-full transition-colors",children:l.is_playing?(0,a.jsx)(h,{size:32}):(0,a.jsx)(x,{size:32})}),(0,a.jsx)("button",{onClick:()=>r("next"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,a.jsx)(u,{size:24})})]})]})})}function y(e){let{progress_ms:t,duration_ms:s}=e,l=t/s*100,r=e=>{let t=Math.floor(e/1e3%60),s=Math.floor(e/1e3/60);return"".concat(s,":").concat(t.toString().padStart(2,"0"))};return(0,a.jsxs)("div",{className:"w-full space-y-2",children:[(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,a.jsx)("div",{className:"bg-green-600 h-1.5 rounded-full transition-all duration-1000",style:{width:"".concat(l,"%")}})}),(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-500",children:[(0,a.jsx)("span",{children:r(t)}),(0,a.jsx)("span",{children:r(s)})]})]})}function p(e){let{artists:t}=e;return(null==t?void 0:t.length)?(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h2",{className:"text-2xl text-gray-900 font-bold mb-6",children:"Top Artists This Month"}),(0,a.jsx)("div",{className:"space-y-4",children:t.map((e,t)=>{var s,l;return(0,a.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,a.jsx)("span",{className:"text-2xl font-bold text-gray-400 w-8",children:t+1}),(null===(s=e.images)||void 0===s?void 0:s[0])&&(0,a.jsx)("img",{src:e.images[0].url,alt:e.name,className:"w-16 h-16 rounded-full shadow-md"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 text-lg",children:e.name}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:null===(l=e.genres)||void 0===l?void 0:l.slice(0,2).join(", ")}),(0,a.jsxs)("p",{className:"text-sm font-medium text-green-600",children:[e.approximateMinutesListened," minutes listened"]})]})]})]},e.id)})})]}):null}function f(e){let{tracks:t}=e;return(null==t?void 0:t.length)?(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h2",{className:"text-2xl text-gray-900 font-bold mb-6",children:"Top Tracks This Month"}),(0,a.jsx)("div",{className:"space-y-4",children:t.map((e,t)=>{var s,l,r;return(0,a.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,a.jsx)("span",{className:"text-2xl font-bold text-gray-400 w-8",children:t+1}),(null===(l=e.album)||void 0===l?void 0:null===(s=l.images)||void 0===s?void 0:s[0])&&(0,a.jsx)("img",{src:e.album.images[0].url,alt:e.name,className:"w-16 h-16 rounded shadow-md"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 text-lg",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:null===(r=e.artists)||void 0===r?void 0:r.map(e=>e.name).join(", ")})]})]},e.id)})})]}):null}function j(e){let{totalMinutes:t}=e;return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h2",{className:"text-2xl text-gray-900 font-bold mb-4",children:"Monthly Listening Time"}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("p",{className:"text-4xl font-bold text-green-600",children:[t," minutes"]}),(0,a.jsxs)("p",{className:"text-gray-600",children:["That's about ",Math.round(t/60)," hours!"]})]})]})}let v="https://spotify.api.itsandy.co";function b(){let[e,t]=(0,l.useState)(null),[s,r]=(0,l.useState)([]),[n,i]=(0,l.useState)([]),[o,c]=(0,l.useState)(0),[d,m]=(0,l.useState)(!0),[h,x]=(0,l.useState)(null),[u,y]=(0,l.useState)(!0);(0,l.useEffect)(()=>{let e=new URLSearchParams(window.location.search),t=e.get("access_token"),s=e.get("refresh_token");t&&s&&(localStorage.setItem("spotify_access_token",t),localStorage.setItem("spotify_refresh_token",s),window.history.replaceState({},document.title,window.location.pathname))},[]);let b=()=>{let e=localStorage.getItem("spotify_access_token");return e||(window.location.href="https://spotify.api.itsandy.co/login"),"Bearer ".concat(e)};(0,l.useEffect)(()=>{let e;w(),N();let t=()=>{u&&(e=setTimeout(async()=>{await w(),t()},1e3))};return t(),()=>{e&&clearTimeout(e),y(!1)}},[u]),(0,l.useEffect)(()=>{let e=()=>{y(!document.hidden)};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[]),(0,l.useEffect)(()=>{w(),N();let e=setInterval(w,3e4);return()=>clearInterval(e)},[]);let w=async()=>{try{let e=await fetch("".concat(v,"/currently-playing"),{headers:{Authorization:b()}});if(e.ok){let s=await e.json();t(s)}}catch(e){console.error("Error fetching current track:",e)}},N=async()=>{try{let[e,t,s]=await Promise.all([fetch("".concat(v,"/top-artists-detailed"),{credentials:"include"}),fetch("".concat(v,"/top-tracks"),{credentials:"include"}),fetch("".concat(v,"/recent-tracks"),{credentials:"include"})]);if(!e.ok||!t.ok||!s.ok)throw Error("Failed to fetch data");let[a,l,n]=await Promise.all([e.json(),t.json(),s.json()]);r(a),i(l.items||[]),c(n.totalMinutes)}catch(e){x(e.message)}finally{m(!1)}},k=async e=>{try{await fetch("".concat(v,"/player/").concat(e),{method:"POST",Authorization:b()}),w()}catch(e){console.error("Error controlling playback:",e)}};return h?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-100 to-blue-100 p-8",children:(0,a.jsx)("div",{className:"max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-xl text-gray-900 font-semibold mb-4",children:"Please log in to see your Spotify analytics"}),(0,a.jsx)("button",{onClick:()=>{window.location.href="".concat(v,"/login")},className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",children:"Login with Spotify"})]})})}):d?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-100 to-blue-100 p-8",children:(0,a.jsx)("div",{className:"max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-6",children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("p",{children:"Loading your Spotify data..."})})})}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-100 to-blue-100 p-8",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-3xl text-gray-900 font-bold text-center mb-8",children:"Your Spotify Analytics"}),(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)(g,{currentTrack:e,onPlaybackControl:k}),(0,a.jsx)(j,{totalMinutes:o}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsx)(p,{artists:s}),(0,a.jsx)(f,{tracks:n})]})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(7342)),_N_E=e.O()}]);